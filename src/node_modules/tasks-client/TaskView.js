"use strict";

var React = require('react.backbone');
var validation = require('backbone-validation');

module.exports = React.createBackboneClass({
  getInitialState: function () {
    return { errors: {}, saved: true };
  },
  render: require('./Task.jsx'),
  destroy: function (event) {
    this.model().destroy();
  },
  save: function (event) {
    var self = this;
    this.model().save(null, {
      success: function () {
        self.setState.call(self, { saved: true });
      },
      error: function () {
        console.error("save error");
      },
    });
  },
  onChange: function(prop) {
    var self = this;
    return function () {
      self.model().set(prop, event.target.value);
      self.setState.call(self, { saved: false });
    };
  },
  componentWillMount: function (rootEl) {
    // bind view to collection
    validation.bind(this, {
      model: this.model(),
    });
  },
});
